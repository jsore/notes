<!-- â€¦/blog/packtblog/blog/templates/blog/post/detail.html -->

{% extends "blog/base.html" %}

{% block title %}
  {{ post.title }}
{% endblock title %}

{% block content %}

  <h1>{{ post.title }}</h1>

  <p classs="date">
    Published {{ post.publish }} by {{ post.author }}
  </p>

  {{ post.body|linebreaks }}

  <p>
    <a href='{% url "blog:post_share" post.id %}'>
      Share this post
    </a>
  </p>

  <!-- execute a comments.count() QuerySet -->
  <!--
      the 'with' template tag helps avoid hitting the DB or
      accessing expensive methods multiple times, the supplied
      variable will only be available for use until the end
      of this tag block
  -->
  {% with comments.count as total_comments %}
    <h2>
      {{ total_comments }} comment{{ total_comments|pluralize }}
    </h2>
  {% endwith %}

  <!-- loop to list the comments -->
  {% for comment in comments %}
    <div class="comment">
      <p class="info">
        <!-- enumerate comments with a loop iteration counter -->
        Comment {{ forloop.counter }} by {{ comment.name }}
        {{ comment.created }}
      </p>
      {{ comment.body|linebreaks }}
    </div>
  {% empty %}
    <p>There are no comments yet.</p>
  {% endfor %}

  <!-- render the form or display a success message -->
  {% if new_comment %}
    <h2>Your comment has been added.</h2>
  {% else %}
    <h2>Add a new comment</h2>
    <form action="" method="post">
      {{ comment_form.as_p }}
      {% csrf_token %}
      <p><input type="submit" value="Add comment" /></p>
    </form>
  {% endif %}

{% endblock content %}
